<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="517px" preserveAspectRatio="none" style="width:585px;height:517px;" version="1.1" viewBox="0 0 585 517" width="585px" zoomAndPan="magnify"><defs><filter height="300%" id="f13vcie53a05sd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="254.5" y="22.9951">tlsrouter</text><rect fill="#ADD8E6" height="471.7891" style="stroke: #A80036; stroke-width: 1.0;" width="270" x="71" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="189" x="111.5" y="46.3638">Service Namespace (id:x)</text><rect fill="#FFFFFF" height="471.7891" style="stroke: #A80036; stroke-width: 1.0;" width="231" x="343" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="191" x="363" y="46.3638">Default Namespace (id:0)</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="36" x2="36" y1="115.7266" y2="440.7891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="134" x2="134" y1="115.7266" y2="440.7891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="270" x2="270" y1="115.7266" y2="440.7891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="417" x2="417" y1="115.7266" y2="440.7891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="533" x2="533" y1="115.7266" y2="440.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="8" y="112.4248">kubectl</text><ellipse cx="36.5" cy="83.4297" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="24.5" x2="48.5" y1="97.4297" y2="97.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="8" y="452.7842">kubectl</text><ellipse cx="36.5" cy="472.0859" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="24.5" x2="48.5" y1="486.0859" y2="486.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="75" y="112.4248">tlsrouter-service</text><ellipse cx="134" cy="83.4297" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="122" x2="146" y1="97.4297" y2="97.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="75" y="452.7842">tlsrouter-service</text><ellipse cx="134" cy="472.0859" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="122" x2="146" y1="486.0859" y2="486.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="203" y="112.4248">tlsrouter-container</text><ellipse cx="270" cy="83.4297" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="258" x2="282" y1="97.4297" y2="97.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="203" y="452.7842">tlsrouter-container</text><ellipse cx="270" cy="472.0859" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="258" x2="282" y1="486.0859" y2="486.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="347" y="112.4248">kubernetes-service</text><ellipse cx="417" cy="83.4297" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="405" x2="429" y1="97.4297" y2="97.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="347" y="452.7842">kubernetes-service</text><ellipse cx="417" cy="472.0859" fill="#FEFECE" filter="url(#f13vcie53a05sd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="405" x2="429" y1="486.0859" y2="486.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="497" y="112.4248">certificate</text><path d="M515.5,63.4297 C515.5,53.4297 533.5,53.4297 533.5,53.4297 C533.5,53.4297 551.5,53.4297 551.5,63.4297 L551.5,89.4297 C551.5,99.4297 533.5,99.4297 533.5,99.4297 C533.5,99.4297 515.5,99.4297 515.5,89.4297 L515.5,63.4297 " fill="#FEFECE" filter="url(#f13vcie53a05sd)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M515.5,63.4297 C515.5,73.4297 533.5,73.4297 533.5,73.4297 C533.5,73.4297 551.5,73.4297 551.5,63.4297 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="497" y="452.7842">certificate</text><path d="M515.5,466.0859 C515.5,456.0859 533.5,456.0859 533.5,456.0859 C533.5,456.0859 551.5,456.0859 551.5,466.0859 L551.5,492.0859 C551.5,502.0859 533.5,502.0859 533.5,502.0859 C533.5,502.0859 515.5,502.0859 515.5,492.0859 L515.5,466.0859 " fill="#FEFECE" filter="url(#f13vcie53a05sd)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M515.5,466.0859 C515.5,476.0859 533.5,476.0859 533.5,476.0859 C533.5,476.0859 551.5,476.0859 551.5,466.0859 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="122,142.7266,132,146.7266,122,150.7266,126,146.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="128" y1="146.7266" y2="146.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="43.5" y="141.7935">L3/tcp/443</text><polygon fill="#A80036" points="258,171.8594,268,175.8594,258,179.8594,262,175.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="134" x2="264" y1="175.8594" y2="175.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="141" y="170.9263">L4/https/443</text><polygon fill="#FBFB77" filter="url(#f13vcie53a05sd)" points="139,188.9922,139,213.9922,284,213.9922,284,198.9922,274,188.9922,139,188.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="274" x2="274" y1="188.9922" y2="198.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="284" x2="274" y1="198.9922" y2="198.9922"/><ellipse cx="150.5" cy="201.625" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="156" y="206.0591">TCP Pass-through</text><polygon fill="#A80036" points="405,240.125,415,244.125,405,248.125,409,244.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="270" x2="411" y1="244.125" y2="244.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="277" y="239.1919">L4/https/443</text><polygon fill="#FBFB77" filter="url(#f13vcie53a05sd)" points="275,257.2578,275,312.2578,419,312.2578,419,267.2578,409,257.2578,275,257.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="409" x2="409" y1="257.2578" y2="267.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="419" x2="409" y1="267.2578" y2="267.2578"/><ellipse cx="286.5" cy="269.8906" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="292" y="274.3247">SNI inspection</text><ellipse cx="286.5" cy="285.0234" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="292" y="289.4575">Routing decision</text><ellipse cx="286.5" cy="300.1563" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="292" y="304.5903">TLS Pass-through</text><polygon fill="#A80036" points="521.5,323.6563,531.5,327.6563,521.5,331.6563,525.5,327.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="417" x2="527.5" y1="327.6563" y2="327.6563"/><polygon fill="#FBFB77" filter="url(#f13vcie53a05sd)" points="422,340.6563,422,365.6563,555,365.6563,555,350.6563,545,340.6563,422,340.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="545" x2="545" y1="340.6563" y2="350.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="555" x2="545" y1="350.6563" y2="350.6563"/><ellipse cx="433.5" cy="353.2891" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="439" y="357.7231">TLS termination</text><polygon fill="#A80036" points="428,376.7891,418,380.7891,428,384.7891,424,380.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="422" x2="532.5" y1="380.7891" y2="380.7891"/><polygon fill="#A80036" points="281,390.7891,271,394.7891,281,398.7891,277,394.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="275" x2="416" y1="394.7891" y2="394.7891"/><polygon fill="#A80036" points="145,404.7891,135,408.7891,145,412.7891,141,408.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="139" x2="269" y1="408.7891" y2="408.7891"/><polygon fill="#A80036" points="47.5,418.7891,37.5,422.7891,47.5,426.7891,43.5,422.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="133" y1="422.7891" y2="422.7891"/><!--
@startuml

title tlsrouter

entity "kubectl" as kubectl

box "Service Namespace (id:x)" #lightblue
  entity "tlsrouter-service" as tlsrouter_service
  entity "tlsrouter-container" as tlsrouter_container
end box

box "Default Namespace (id:0)" #white
  entity "kubernetes-service" as kubernetes_service
  database "certificate" as certificate
end box

kubectl -> tlsrouter_service : L3/tcp/443
tlsrouter_service -> tlsrouter_container : L4/https/443
note right of tlsrouter_service
  * TCP Pass-through
end note
tlsrouter_container -> kubernetes_service : L4/https/443
note right of tlsrouter_container
  * SNI inspection
  * Routing decision
  * TLS Pass-through
end note
kubernetes_service -> certificate
note right of kubernetes_service
  * TLS termination
end note
certificate -> kubernetes_service
kubernetes_service -> tlsrouter_container
tlsrouter_container -> tlsrouter_service
tlsrouter_service -> kubectl

@enduml

PlantUML version 1.2017.19(Sun Nov 12 22:46:22 AEDT 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Linux
OS Version: 4.4.0-137-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>